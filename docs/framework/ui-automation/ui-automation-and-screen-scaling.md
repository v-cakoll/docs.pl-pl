---
title: Automatyzacja interfejsu użytkownika a skalowanie ekranu
description: Przeczytaj, jak skalowanie ekranu obsługi systemu Windows i interfejsu użytkownika. Menedżer DWM obsługuje domyślne skalowanie dla wszystkich aplikacji, które muszą uwzględniać aplikacje klienckie automatyzacji interfejsu użytkownika.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- scaling, screens
- screens, scaling
- UI (user interface), automation
- UI Automation
ms.assetid: 4380cad7-e509-448f-b9a5-6de042605fd4
ms.openlocfilehash: 99239d7bac2e556d4da0d74f36c68916da7c688a
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/24/2020
ms.locfileid: "87164012"
---
# <a name="ui-automation-and-screen-scaling"></a><span data-ttu-id="43dcf-104">Automatyzacja interfejsu użytkownika a skalowanie ekranu</span><span class="sxs-lookup"><span data-stu-id="43dcf-104">UI Automation and Screen Scaling</span></span>
> [!NOTE]
> <span data-ttu-id="43dcf-105">Ta dokumentacja jest przeznaczona dla .NET Framework deweloperów, którzy chcą korzystać z zarządzanych [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] klas zdefiniowanych w <xref:System.Windows.Automation> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="43dcf-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="43dcf-106">Aby uzyskać najnowsze informacje na temat [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , zobacz [interfejs API usługi Windows Automation: Automatyzacja interfejsu użytkownika](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="43dcf-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
<span data-ttu-id="43dcf-107">Począwszy od systemu Windows Vista, system Windows umożliwia użytkownikom zmianę ustawienia kropek na cal (dpi), tak aby większość elementów interfejsu użytkownika na ekranie była większa.</span><span class="sxs-lookup"><span data-stu-id="43dcf-107">Starting with Windows Vista, Windows enables users to change the dots per inch (dpi) setting so that most user interface (UI) elements on the screen appear larger.</span></span> <span data-ttu-id="43dcf-108">Mimo że ta funkcja jest dostępna w systemie Windows, we wcześniejszych wersjach skalowanie musiało zostać zaimplementowane przez aplikacje.</span><span class="sxs-lookup"><span data-stu-id="43dcf-108">Although this feature has long been available in Windows, in previous versions the scaling had to be implemented by applications.</span></span> <span data-ttu-id="43dcf-109">Począwszy od systemu Windows Vista, Menedżer okien pulpitu wykonuje domyślne skalowanie dla wszystkich aplikacji, które nie obsługują własnego skalowania.</span><span class="sxs-lookup"><span data-stu-id="43dcf-109">Starting with Windows Vista, the Desktop Window Manager performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="43dcf-110">Aplikacje klienckie automatyzacji interfejsu użytkownika muszą korzystać z tej funkcji w ramach konta.</span><span class="sxs-lookup"><span data-stu-id="43dcf-110">UI Automation client applications must take this feature into account.</span></span>  
  
<a name="Scaling_in_Windows_Vista"></a>
## <a name="scaling-in-windows-vista"></a><span data-ttu-id="43dcf-111">Skalowanie w systemie Windows Vista</span><span class="sxs-lookup"><span data-stu-id="43dcf-111">Scaling in Windows Vista</span></span>  
 <span data-ttu-id="43dcf-112">Domyślnym ustawieniem DPI jest 96, co oznacza, że 96 pikseli zajmują szerokość lub wysokość jednego zakładanego cala.</span><span class="sxs-lookup"><span data-stu-id="43dcf-112">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="43dcf-113">Dokładna miara "CAL" zależy od rozmiaru i fizycznej rozdzielczości monitora.</span><span class="sxs-lookup"><span data-stu-id="43dcf-113">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="43dcf-114">Na przykład w przypadku monitora o szerokości 12 cali, w rozdzielczości poziomej 1280 pikseli, pozioma linia 96 pikseli rozciąga się na około 9/10 cala.</span><span class="sxs-lookup"><span data-stu-id="43dcf-114">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>  
  
 <span data-ttu-id="43dcf-115">Zmiana ustawienia DPI nie jest taka sama jak zmiana rozdzielczości ekranu.</span><span class="sxs-lookup"><span data-stu-id="43dcf-115">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="43dcf-116">W przypadku skalowania dpi liczba pikseli fizycznych na ekranie pozostaje taka sama.</span><span class="sxs-lookup"><span data-stu-id="43dcf-116">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="43dcf-117">Jednak skalowanie jest stosowane do rozmiaru i lokalizacji [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elementów.</span><span class="sxs-lookup"><span data-stu-id="43dcf-117">However, scaling is applied to the size and location of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="43dcf-118">Skalowanie może być wykonywane automatycznie przez Menedżer okien pulpitu (DWM) dla komputerów stacjonarnych i dla aplikacji, które nie proszą jawnie o skalowanie.</span><span class="sxs-lookup"><span data-stu-id="43dcf-118">This scaling can be performed automatically by the Desktop Window Manager (DWM) for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>  
  
 <span data-ttu-id="43dcf-119">W efekcie, gdy użytkownik ustawia współczynnik skalowania na 120 DPI, poziom pionowy lub poziomy na ekranie będzie większy o 25%.</span><span class="sxs-lookup"><span data-stu-id="43dcf-119">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="43dcf-120">Wszystkie wymiary są odpowiednio skalowane.</span><span class="sxs-lookup"><span data-stu-id="43dcf-120">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="43dcf-121">Przesunięcie okna aplikacji od górnej i lewej krawędzi ekranu zwiększa się o 25%.</span><span class="sxs-lookup"><span data-stu-id="43dcf-121">The offset of an application window from the top and left edges of the screen increases by 25 percent.</span></span> <span data-ttu-id="43dcf-122">Jeśli skalowanie aplikacji jest włączone i aplikacja nie obsługuje rozdzielczości DPI, rozmiar okna zwiększa się w tej samej proporcji wraz z przesunięciami i rozmiarem wszystkich elementów, które [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] zawiera.</span><span class="sxs-lookup"><span data-stu-id="43dcf-122">If application scaling is enabled and the application is not dpi-aware, the size of the window increases in the same proportion, along with the offsets and sizes of all [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements it contains.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="43dcf-123">Domyślnie Menedżer DWM nie wykonuje skalowania dla aplikacji nieobsługujących rozdzielczości DPI, gdy użytkownik ustawia wartość DPI na 120, ale wykonuje ją, gdy dla dpi zostanie ustawiona niestandardowa wartości 144 lub wyższej.</span><span class="sxs-lookup"><span data-stu-id="43dcf-123">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform it when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="43dcf-124">Jednak użytkownik może zastąpić zachowanie domyślne.</span><span class="sxs-lookup"><span data-stu-id="43dcf-124">However, the user can override the default behavior.</span></span>  
  
 <span data-ttu-id="43dcf-125">Skalowanie ekranu tworzy nowe wyzwania dla aplikacji, które są zainteresowane w dowolny sposób z współrzędnymi ekranu.</span><span class="sxs-lookup"><span data-stu-id="43dcf-125">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="43dcf-126">Na ekranie znajdują się teraz dwa systemy współrzędnych: fizyczne i logiczne.</span><span class="sxs-lookup"><span data-stu-id="43dcf-126">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="43dcf-127">Współrzędne fizyczne punktu to rzeczywiste przesunięcie (w pikselach) od lewego górnego rogu pochodzenia.</span><span class="sxs-lookup"><span data-stu-id="43dcf-127">The physical coordinates of a point are the actual offset in pixels from the top left of the origin.</span></span> <span data-ttu-id="43dcf-128">Współrzędne logiczne są przesunięciami, tak jak gdyby same piksele były skalowane.</span><span class="sxs-lookup"><span data-stu-id="43dcf-128">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>  
  
 <span data-ttu-id="43dcf-129">Załóżmy, że zaprojektowano okno dialogowe z przyciskiem we współrzędnych (100, 48).</span><span class="sxs-lookup"><span data-stu-id="43dcf-129">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="43dcf-130">Gdy to okno dialogowe jest wyświetlane domyślnie 96 dpi, przycisk znajduje się w fizycznych współrzędnych (100, 48).</span><span class="sxs-lookup"><span data-stu-id="43dcf-130">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="43dcf-131">O 120 DPI, znajduje się on w fizycznych współrzędnych (125, 60).</span><span class="sxs-lookup"><span data-stu-id="43dcf-131">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="43dcf-132">Jednak współrzędne logiczne są takie same w dowolnym ustawieniu dpi: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="43dcf-132">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>  
  
 <span data-ttu-id="43dcf-133">Współrzędne logiczne są ważne, ponieważ sprawiają, że zachowanie systemu operacyjnego i aplikacji jest spójne niezależnie od ustawienia DPI.</span><span class="sxs-lookup"><span data-stu-id="43dcf-133">Logical coordinates are important, because they make the behavior of the operating system and applications consistent regardless of the dpi setting.</span></span> <span data-ttu-id="43dcf-134">Na przykład <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> zwykle zwraca współrzędne logiczne.</span><span class="sxs-lookup"><span data-stu-id="43dcf-134">For example, <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> normally returns the logical coordinates.</span></span> <span data-ttu-id="43dcf-135">Jeśli przesuniesz kursor nad element w oknie dialogowym, te same współrzędne są zwracane niezależnie od ustawienia DPI.</span><span class="sxs-lookup"><span data-stu-id="43dcf-135">If you move the cursor over an element in a dialog box, the same coordinates are returned regardless of the dpi setting.</span></span> <span data-ttu-id="43dcf-136">Jeśli narysujesz formant w (100, 100), jest on rysowany jako współrzędne logiczne i zastąpi to samo względne położenie przy użyciu dowolnego ustawienia DPI.</span><span class="sxs-lookup"><span data-stu-id="43dcf-136">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>  
  
<a name="Scaling_in_UI_Automation_Clients"></a>
## <a name="scaling-in-ui-automation-clients"></a><span data-ttu-id="43dcf-137">Skalowanie w klientach automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="43dcf-137">Scaling in UI Automation Clients</span></span>  
 <span data-ttu-id="43dcf-138">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]Interfejs API nie używa współrzędnych logicznych.</span><span class="sxs-lookup"><span data-stu-id="43dcf-138">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] API does not use logical coordinates.</span></span> <span data-ttu-id="43dcf-139">Następujące metody i właściwości zwracają współrzędne fizyczne lub przyjmują je jako parametry.</span><span class="sxs-lookup"><span data-stu-id="43dcf-139">The following methods and properties either return physical coordinates or take them as parameters.</span></span>  
  
- <xref:System.Windows.Automation.AutomationElement.GetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.TryGetClickablePoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.ClickablePointProperty>  
  
- <xref:System.Windows.Automation.AutomationElement.FromPoint%2A>  
  
- <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.BoundingRectangle%2A>  
  
 <span data-ttu-id="43dcf-140">Domyślnie aplikacja klienta automatyzacji interfejsu użytkownika działająca w środowisku innym niż 96 dpi nie będzie mogła uzyskać prawidłowych wyników z tych metod i właściwości.</span><span class="sxs-lookup"><span data-stu-id="43dcf-140">By default, a UI Automation client application running in a non-96- dpi environment will not be able to obtain correct results from these methods and properties.</span></span> <span data-ttu-id="43dcf-141">Na przykład ze względu na to, że położenie kursora jest zgodne ze współrzędnymi logicznymi, klient nie może po prostu przekazać tych współrzędnych w <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> celu uzyskania elementu znajdującego się pod kursorem.</span><span class="sxs-lookup"><span data-stu-id="43dcf-141">For example, because the cursor position is in logical coordinates, the client cannot simply pass these coordinates to <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> to obtain the element that is under the cursor.</span></span> <span data-ttu-id="43dcf-142">Ponadto aplikacja nie będzie w stanie poprawnie umieścić okien poza jego obszarem klienckim.</span><span class="sxs-lookup"><span data-stu-id="43dcf-142">In addition, the application will not be able to correctly place windows outside its client area.</span></span>  
  
 <span data-ttu-id="43dcf-143">Rozwiązanie znajduje się w dwóch częściach.</span><span class="sxs-lookup"><span data-stu-id="43dcf-143">The solution is in two parts.</span></span>  
  
1. <span data-ttu-id="43dcf-144">Najpierw należy pamiętać o rozdzielczości DPI aplikacji klienta.</span><span class="sxs-lookup"><span data-stu-id="43dcf-144">First, make the client application dpi-aware.</span></span> <span data-ttu-id="43dcf-145">W tym celu wywołaj funkcję Win32 `SetProcessDPIAware` przy uruchamianiu.</span><span class="sxs-lookup"><span data-stu-id="43dcf-145">To do this, call the Win32 function `SetProcessDPIAware` at startup.</span></span> <span data-ttu-id="43dcf-146">W kodzie zarządzanym następująca deklaracja udostępnia tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="43dcf-146">In managed code, the following declaration makes this function available.</span></span>  
  
     [!code-csharp[Highlighter#101](../../../samples/snippets/csharp/VS_Snippets_Wpf/Highlighter/CSharp/NativeMethods.cs#101)]
     [!code-vb[Highlighter#101](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/Highlighter/VisualBasic/NativeMethods.vb#101)]  
  
     <span data-ttu-id="43dcf-147">Ta funkcja wykonuje cały proces z uwzględnieniem rozdzielczości DPI, co oznacza, że wszystkie okna, które należą do procesu, nie są skalowane.</span><span class="sxs-lookup"><span data-stu-id="43dcf-147">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span> <span data-ttu-id="43dcf-148">W [przykładzie wyróżnienia](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter), na przykład cztery okna, które tworzą prostokąt wyróżnienia, znajdują się na współrzędnych fizycznych uzyskanych z automatyzacji interfejsu użytkownika, a nie na współrzędnych logicznych.</span><span class="sxs-lookup"><span data-stu-id="43dcf-148">In the [Highlighter Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter), for instance, the four windows that make up the highlight rectangle are located at the physical coordinates obtained from UI Automation, not the logical coordinates.</span></span> <span data-ttu-id="43dcf-149">Jeśli próbka nie była uwzględniana przy użyciu rozdzielczości DPI, wyróżnienie zostanie narysowane na współrzędne logiczne na pulpicie, co spowoduje nieprawidłowe umieszczenie w środowisku innym niż 96 dpi.</span><span class="sxs-lookup"><span data-stu-id="43dcf-149">If the sample were not dpi-aware, the highlight would be drawn at the logical coordinates on the desktop, which would result in incorrect placement in a non-96- dpi environment.</span></span>  
  
2. <span data-ttu-id="43dcf-150">Aby uzyskać współrzędne kursora, wywołaj funkcję Win32 `GetPhysicalCursorPos` .</span><span class="sxs-lookup"><span data-stu-id="43dcf-150">To get cursor coordinates, call the Win32 function `GetPhysicalCursorPos`.</span></span> <span data-ttu-id="43dcf-151">Poniższy przykład pokazuje, jak zadeklarować tę funkcję i korzystać z niej.</span><span class="sxs-lookup"><span data-stu-id="43dcf-151">The following example shows how to declare and use this function.</span></span>  
  
     [!code-csharp[UIAClient_snip#185](../../../samples/snippets/csharp/VS_Snippets_Wpf/UIAClient_snip/CSharp/ClientForm.cs#185)]
     [!code-vb[UIAClient_snip#185](../../../samples/snippets/visualbasic/VS_Snippets_Wpf/UIAClient_snip/VisualBasic/ClientForm.vb#185)]  
  
> [!CAUTION]
> <span data-ttu-id="43dcf-152">Nie należy używać <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="43dcf-152">Do not use <xref:System.Windows.Forms.Cursor.Position%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="43dcf-153">Zachowanie tej właściwości poza oknami klienckimi w środowisku skalowanym jest niezdefiniowane.</span><span class="sxs-lookup"><span data-stu-id="43dcf-153">The behavior of this property outside client windows in a scaled environment is undefined.</span></span>  
  
 <span data-ttu-id="43dcf-154">Jeśli aplikacja wykonuje bezpośrednią komunikację międzyprocesową z aplikacjami obsługującymi funkcję bez użycia rozdzielczości DPI, można skonwertować współrzędne logiczne i fizyczne przy użyciu funkcji Win32 `PhysicalToLogicalPoint` i `LogicalToPhysicalPoint` .</span><span class="sxs-lookup"><span data-stu-id="43dcf-154">If your application performs direct cross-process communication with non- dpi-aware applications, you may have convert between logical and physical coordinates by using the Win32 functions `PhysicalToLogicalPoint` and `LogicalToPhysicalPoint`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="43dcf-155">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="43dcf-155">See also</span></span>

- [<span data-ttu-id="43dcf-156">Wyróżnij przykład</span><span class="sxs-lookup"><span data-stu-id="43dcf-156">Highlighter Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/Highlighter)
