---
title: Korzystanie z sesji
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- sessions [WCF]
ms.assetid: 864ba12f-3331-4359-a359-6d6d387f1035
ms.openlocfilehash: a879e90aeab7b40529df1f1a60cd1f879c39720a
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/12/2020
ms.locfileid: "79143177"
---
# <a name="using-sessions"></a><span data-ttu-id="edd3f-102">Korzystanie z sesji</span><span class="sxs-lookup"><span data-stu-id="edd3f-102">Using Sessions</span></span>
<span data-ttu-id="edd3f-103">W aplikacjach Windows Communication Foundation (WCF) *sesja* koreluje grupę wiadomości do konwersacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-103">In Windows Communication Foundation (WCF) applications, a *session* correlates a group of messages into a conversation.</span></span> <span data-ttu-id="edd3f-104">Sesje WCF różnią się od obiektu sesji dostępnego w ASP.NET aplikacji, obsługują różne zachowania i są kontrolowane na różne sposoby.</span><span class="sxs-lookup"><span data-stu-id="edd3f-104">WCF sessions are different than the session object available in ASP.NET applications, support different behaviors, and are controlled in different ways.</span></span> <span data-ttu-id="edd3f-105">W tym temacie opisano funkcje, które sesje włączyć w aplikacjach WCF i jak z nich korzystać.</span><span class="sxs-lookup"><span data-stu-id="edd3f-105">This topic describes the features that sessions enable in WCF applications and how to use them.</span></span>  
  
## <a name="sessions-in-windows-communication-foundation-applications"></a><span data-ttu-id="edd3f-106">Sesje w aplikacjach programu Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="edd3f-106">Sessions in Windows Communication Foundation Applications</span></span>  
 <span data-ttu-id="edd3f-107">Gdy umowa serwisowa określa, że wymaga sesji, że umowa określa, że wszystkie wywołania (czyli podstawowe wymiany komunikatów, które obsługują wywołania) musi być częścią tej samej konwersacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-107">When a service contract specifies that it requires a session, that contract is specifying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="edd3f-108">Jeśli umowa określa, że zezwala na sesje, ale nie wymaga jednego, klienci mogą łączyć się i ustanawiać sesję lub nie ustanawiać sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-108">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not establish a session.</span></span> <span data-ttu-id="edd3f-109">Jeśli sesja kończy się i wiadomość jest wysyłana za pośrednictwem tego samego kanału wyjątek.</span><span class="sxs-lookup"><span data-stu-id="edd3f-109">If the session ends and a message is sent through the same channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="edd3f-110">Sesje WCF mają następujące główne funkcje koncepcyjne:</span><span class="sxs-lookup"><span data-stu-id="edd3f-110">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="edd3f-111">Są one jawnie inicjowane i zakończone przez aplikację wywołującą (klienta WCF).</span><span class="sxs-lookup"><span data-stu-id="edd3f-111">They are explicitly initiated and terminated by the calling application (the WCF client).</span></span>  
  
- <span data-ttu-id="edd3f-112">Wiadomości dostarczane podczas sesji są przetwarzane w kolejności, w jakiej są odbierane.</span><span class="sxs-lookup"><span data-stu-id="edd3f-112">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="edd3f-113">Sesje skorelować grupę wiadomości do konwersacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-113">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="edd3f-114">Możliwe są różne rodzaje korelacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-114">Different types of correlation are possible.</span></span> <span data-ttu-id="edd3f-115">Na przykład jeden kanał oparty na sesji może skorelować wiadomości na podstawie udostępnionego połączenia sieciowego, podczas gdy inny kanał oparty na sesji może skorelować wiadomości na podstawie udostępnionego tagu w treści wiadomości.</span><span class="sxs-lookup"><span data-stu-id="edd3f-115">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="edd3f-116">Funkcje, które mogą pochodzić z sesji zależą od charakteru korelacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-116">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="edd3f-117">Nie ma ogólnego magazynu danych skojarzonego z sesją WCF.</span><span class="sxs-lookup"><span data-stu-id="edd3f-117">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="edd3f-118">Jeśli znasz <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> klasę w ASP.NET aplikacji i funkcji, które zapewnia, można zauważyć następujące różnice między tego rodzaju sesji i WCF sesji:</span><span class="sxs-lookup"><span data-stu-id="edd3f-118">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="edd3f-119">ASP.NET sesje są zawsze inicjowane przez serwer.</span><span class="sxs-lookup"><span data-stu-id="edd3f-119">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="edd3f-120">ASP.NET sesje są niejawnie nieuiarszane.</span><span class="sxs-lookup"><span data-stu-id="edd3f-120">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="edd3f-121">ASP.NET sesji zapewniają ogólny mechanizm przechowywania danych między żądaniami.</span><span class="sxs-lookup"><span data-stu-id="edd3f-121">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="edd3f-122">W tym temacie opisano:</span><span class="sxs-lookup"><span data-stu-id="edd3f-122">This topic describes:</span></span>  
  
- <span data-ttu-id="edd3f-123">Domyślne zachowanie wykonywania podczas korzystania z powiązań opartych na sesji w warstwie modelu usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-123">The default execution behavior when using session-based bindings in the service model layer.</span></span>  
  
- <span data-ttu-id="edd3f-124">Typy funkcji, które WCF sesji oparte, systemowe powiązania zapewniają.</span><span class="sxs-lookup"><span data-stu-id="edd3f-124">The types of features that the WCF session-based, system-provided bindings provide.</span></span>  
  
- <span data-ttu-id="edd3f-125">Jak utworzyć kontrakt, który deklaruje wymaganie sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-125">How to create a contract that declares a session requirement.</span></span>  
  
- <span data-ttu-id="edd3f-126">Jak zrozumieć i kontrolować tworzenie i zakończenie sesji i relacji sesji do wystąpienia usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-126">How to understand and control the creation and termination of the session and the relationship of the session to the service instance.</span></span>  
  
## <a name="default-execution-behavior-using-sessions"></a><span data-ttu-id="edd3f-127">Domyślne zachowanie wykonania przy użyciu sesji</span><span class="sxs-lookup"><span data-stu-id="edd3f-127">Default Execution Behavior Using Sessions</span></span>  
 <span data-ttu-id="edd3f-128">Powiązanie, które próbuje zainicjować sesję, jest nazywane powiązaniem *opartym na sesji.*</span><span class="sxs-lookup"><span data-stu-id="edd3f-128">A binding that attempts to initiate a session is called a *session-based* binding.</span></span> <span data-ttu-id="edd3f-129">Umowy serwisowe określają, że wymagają, zezwalają lub <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> odmawiają powiązania oparte na sesji, ustawiając <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> właściwość w interfejsie umowy serwisowej (lub klasie) na jedną z wartości wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="edd3f-129">Service contracts specify that they require, permit, or refuse session-based bindings by setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on the service contract interface (or class) to one of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration values.</span></span> <span data-ttu-id="edd3f-130">Domyślnie wartość tej właściwości <xref:System.ServiceModel.SessionMode.Allowed>jest , co oznacza, że jeśli klient używa powiązania opartego na sesji z implementacją usługi WCF, usługa ustanawia i używa dostarczonej sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-130">By default, the value of this property is <xref:System.ServiceModel.SessionMode.Allowed>, which means that if a client uses a session-based binding with a WCF service implementation, the service establishes and uses the session provided.</span></span>  
  
 <span data-ttu-id="edd3f-131">Gdy usługa WCF akceptuje sesję klienta, następujące funkcje są domyślnie włączone:</span><span class="sxs-lookup"><span data-stu-id="edd3f-131">When a WCF service accepts a client session, the following features are enabled by default:</span></span>  
  
1. <span data-ttu-id="edd3f-132">Wszystkie wywołania między obiektem klienta WCF są obsługiwane przez to samo wystąpienie usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-132">All calls between a WCF client object are handled by the same service instance.</span></span>  
  
2. <span data-ttu-id="edd3f-133">Różne powiązania oparte na sesji zapewniają dodatkowe funkcje.</span><span class="sxs-lookup"><span data-stu-id="edd3f-133">Different session-based bindings provide additional features.</span></span>  
  
## <a name="system-provided-session-types"></a><span data-ttu-id="edd3f-134">Typy sesji dostarczonych przez system</span><span class="sxs-lookup"><span data-stu-id="edd3f-134">System-Provided Session Types</span></span>  
 <span data-ttu-id="edd3f-135">Powiązanie oparte na sesji obsługuje domyślne skojarzenie wystąpienia usługi z określoną sesją.</span><span class="sxs-lookup"><span data-stu-id="edd3f-135">A session-based binding supports the default association of a service instance with a particular session.</span></span> <span data-ttu-id="edd3f-136">Jednak różne powiązania oparte na sesji obsługują różne funkcje oprócz włączania formantu instancing opartego na sesji wcześniej opisane.</span><span class="sxs-lookup"><span data-stu-id="edd3f-136">However, different session-based bindings support different features in addition to enabling the session-based instancing control previously described.</span></span>  
  
 <span data-ttu-id="edd3f-137">WCF udostępnia następujące typy zachowań aplikacji opartych na sesji:</span><span class="sxs-lookup"><span data-stu-id="edd3f-137">WCF provides the following types of session-based application behavior:</span></span>  
  
- <span data-ttu-id="edd3f-138">Obsługuje <xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> sesje oparte na zabezpieczeniach, w których oba końce komunikacji uzgodniły konkretną bezpieczną rozmowę.</span><span class="sxs-lookup"><span data-stu-id="edd3f-138">The <xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> supports security-based sessions, in which both ends of communication have agreed upon a specific secure conversation.</span></span> <span data-ttu-id="edd3f-139">Aby uzyskać więcej informacji, zobacz [zabezpieczanie usług](securing-services.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-139">For more information, see [Securing Services](securing-services.md).</span></span> <span data-ttu-id="edd3f-140">Na przykład <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> powiązanie, które zawiera obsługę zarówno sesji zabezpieczeń, jak i niezawodnych sesji, domyślnie używa tylko bezpiecznej sesji, która szyfruje i podpisuje wiadomości cyfrowo.</span><span class="sxs-lookup"><span data-stu-id="edd3f-140">For example, the <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> binding, which contains support for both security sessions and reliable sessions, by default uses only a secure session that encrypts and digitally signs messages.</span></span>  
  
- <span data-ttu-id="edd3f-141">Powiązanie <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> obsługuje sesje oparte na protokół TCP/IP, aby upewnić się, że wszystkie komunikaty są skorelowane przez połączenie na poziomie gniazda.</span><span class="sxs-lookup"><span data-stu-id="edd3f-141">The <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> binding supports TCP/IP-based sessions to ensure that all messages are correlated by the connection at the socket level.</span></span>  
  
- <span data-ttu-id="edd3f-142">Element, <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> który implementuje specyfikację WS-ReliableMessaging, zapewnia obsługę niezawodnych sesji, w których wiadomości mogą być skonfigurowane do dostarczania w kolejności i dokładnie raz, zapewniając odbieranie wiadomości nawet podczas podróży wiadomości przez wiele węzłów podczas konwersacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-142">The <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> element, which implements the WS-ReliableMessaging specification, provides support for reliable sessions in which messages can be configured to be delivered in order and exactly once, ensuring messages are received even when messages travel across multiple nodes during the conversation.</span></span> <span data-ttu-id="edd3f-143">Aby uzyskać więcej informacji, zobacz [Niezawodne sesje](./feature-details/reliable-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-143">For more information, see [Reliable Sessions](./feature-details/reliable-sessions.md).</span></span>  
  
- <span data-ttu-id="edd3f-144">Powiązanie <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> zapewnia sesje datagramu usługi MSMQ.</span><span class="sxs-lookup"><span data-stu-id="edd3f-144">The <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> binding provides MSMQ datagram sessions.</span></span> <span data-ttu-id="edd3f-145">Aby uzyskać więcej informacji, zobacz [Kolejki w WCF](./feature-details/queues-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-145">For more information, see [Queues in WCF](./feature-details/queues-in-wcf.md).</span></span>  
  
 <span data-ttu-id="edd3f-146">Ustawienie <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> właściwości nie określa typu sesji, jakiej wymaga kontrakt, tylko tego wymaga.</span><span class="sxs-lookup"><span data-stu-id="edd3f-146">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not specify the type of session the contract requires, only that it requires one.</span></span>  
  
## <a name="creating-a-contract-that-requires-a-session"></a><span data-ttu-id="edd3f-147">Tworzenie kontraktu, który wymaga sesji</span><span class="sxs-lookup"><span data-stu-id="edd3f-147">Creating a Contract That Requires a Session</span></span>  
 <span data-ttu-id="edd3f-148">Tworzenie umowy, która wymaga sesji stwierdza, że grupa operacji, które deklaruje umowa serwisowa muszą być wykonywane w ramach tej samej sesji i że wiadomości muszą być dostarczane w kolejności.</span><span class="sxs-lookup"><span data-stu-id="edd3f-148">Creating a contract that requires a session states that the group of operations that the service contract declares must all be executed within the same session and that messages must be delivered in order.</span></span> <span data-ttu-id="edd3f-149">Aby potwierdzić poziom obsługi sesji, który wymaga <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> umowy serwisowej, ustaw właściwość <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> w interfejsie umowy serwisowej lub klasy do wartości wyliczenia, aby określić, czy umowa:</span><span class="sxs-lookup"><span data-stu-id="edd3f-149">To assert the level of session support that a service contract requires, set the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on your service contract interface or class to the value of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration to specify whether the contract:</span></span>  
  
- <span data-ttu-id="edd3f-150">Wymaga sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-150">Requires a session.</span></span>  
  
- <span data-ttu-id="edd3f-151">Umożliwia klientowi ustanowienie sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-151">Allows a client to establish a session.</span></span>  
  
- <span data-ttu-id="edd3f-152">Zabrania sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-152">Prohibits a session.</span></span>  
  
 <span data-ttu-id="edd3f-153">Ustawienie <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> właściwości nie określa jednak typu zachowania opartego na sesji, które wymaga od umowy.</span><span class="sxs-lookup"><span data-stu-id="edd3f-153">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not, however, specify the type of session-based behavior the contract requires.</span></span> <span data-ttu-id="edd3f-154">Nakazuje WCF potwierdzić w czasie wykonywania, że skonfigurowane powiązanie (który tworzy kanał komunikacji) dla usługi nie, nie lub można ustanowić sesji podczas implementowania usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-154">It instructs WCF to confirm at runtime that the configured binding (which creates the communication channel) for the service does, does not, or can establish a session when implementing a service.</span></span> <span data-ttu-id="edd3f-155">Ponownie powiązanie może spełnić to wymaganie za pomocą dowolnego typu zachowania opartego na sesji, które wybierze — zabezpieczeń, transportu, niezawodne lub niektóre kombinacje.</span><span class="sxs-lookup"><span data-stu-id="edd3f-155">Again, the binding can satisfy that requirement with any type of session-based behavior it chooses—security, transport, reliable, or some combination.</span></span> <span data-ttu-id="edd3f-156">Dokładne zachowanie zależy <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> od wybranej wartości.</span><span class="sxs-lookup"><span data-stu-id="edd3f-156">The exact behavior depends on the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> value selected.</span></span> <span data-ttu-id="edd3f-157">Jeśli skonfigurowane powiązanie usługi nie jest zgodne <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>z wartością , zostanie zgłoszony wyjątek.</span><span class="sxs-lookup"><span data-stu-id="edd3f-157">If the configured binding of the service does not conform to the value of <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, an exception is thrown.</span></span> <span data-ttu-id="edd3f-158">Powiązania i kanały, które tworzą, że sesje pomocy technicznej są uważane za oparte na sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-158">Bindings and the channels they create that support sessions are said to be session-based.</span></span>  
  
 <span data-ttu-id="edd3f-159">Poniższa umowa serwisowa określa, `ICalculatorSession` że wszystkie operacje w sesji muszą być wymieniane w ramach sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-159">The following service contract specifies that all operations in the `ICalculatorSession` must be exchanged within a session.</span></span> <span data-ttu-id="edd3f-160">Żadna z operacji zwraca wartość do `Equals` wywołującego z wyjątkiem metody.</span><span class="sxs-lookup"><span data-stu-id="edd3f-160">None of the operations returns a value to the caller except the `Equals` method.</span></span> <span data-ttu-id="edd3f-161">Jednak `Equals` metoda nie przyjmuje żadnych parametrów i w związku z tym można zwrócić tylko wartość niezerową wewnątrz sesji, w której dane zostały już przekazane do innych operacji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-161">However, the `Equals` method takes no parameters and, therefore, can only return a non-zero value inside a session in which data has already been passed to the other operations.</span></span> <span data-ttu-id="edd3f-162">Ten kontrakt wymaga sesji do poprawnego działania.</span><span class="sxs-lookup"><span data-stu-id="edd3f-162">This contract requires a session to function properly.</span></span> <span data-ttu-id="edd3f-163">Bez sesji skojarzonej z określonym klientem wystąpienie usługi nie ma możliwości poznania, jakie poprzednie dane wysłał ten klient.</span><span class="sxs-lookup"><span data-stu-id="edd3f-163">Without a session associated with a specific client, the service instance has no way of knowing what previous data this client has sent.</span></span>  
  
 [!code-csharp[S_Service_Session#1](../../../samples/snippets/csharp/VS_Snippets_CFX/s_service_session/cs/service.cs#1)]
 [!code-vb[S_Service_Session#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_service_session/vb/service.vb#1)]  
  
 <span data-ttu-id="edd3f-164">Jeśli usługa zezwala na sesję, sesja jest ustanawiana i używana, jeśli klient inicjuje jedną; w przeciwnym razie nie zostanie ustanowiona żadna sesja.</span><span class="sxs-lookup"><span data-stu-id="edd3f-164">If a service allows a session, then a session is established and used if the client initiates one; otherwise, no session is established.</span></span>  
  
## <a name="sessions-and-service-instances"></a><span data-ttu-id="edd3f-165">Sesje i wystąpienia usługi</span><span class="sxs-lookup"><span data-stu-id="edd3f-165">Sessions and Service Instances</span></span>  
 <span data-ttu-id="edd3f-166">Jeśli używasz domyślnego zachowania instancing w WCF, wszystkie wywołania między obiektem klienta WCF są obsługiwane przez to samo wystąpienie usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-166">If you use the default instancing behavior in WCF, all calls between a WCF client object are handled by the same service instance.</span></span> <span data-ttu-id="edd3f-167">W związku z tym na poziomie aplikacji można myśleć o sesji jako włączenie zachowania aplikacji podobne do zachowania wywołania lokalnego.</span><span class="sxs-lookup"><span data-stu-id="edd3f-167">Therefore, at the application level, you can think of a session as enabling application behavior similar to local call behavior.</span></span> <span data-ttu-id="edd3f-168">Na przykład podczas tworzenia obiektu lokalnego:</span><span class="sxs-lookup"><span data-stu-id="edd3f-168">For example, when you create a local object:</span></span>  
  
- <span data-ttu-id="edd3f-169">Konstruktor jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="edd3f-169">A constructor is called.</span></span>  
  
- <span data-ttu-id="edd3f-170">Wszystkie kolejne wywołania do odwołania do obiektu klienta WCF są przetwarzane przez to samo wystąpienie obiektu.</span><span class="sxs-lookup"><span data-stu-id="edd3f-170">All subsequent calls made to the WCF client object reference are processed by the same object instance.</span></span>  
  
- <span data-ttu-id="edd3f-171">Destruktor jest wywoływany, gdy odwołanie do obiektu jest niszczony.</span><span class="sxs-lookup"><span data-stu-id="edd3f-171">A destructor is called when the object reference is destroyed.</span></span>  
  
 <span data-ttu-id="edd3f-172">Sesje włączyć podobne zachowanie między klientami i usługami, tak długo, jak domyślne zachowanie wystąpienia usługi jest używany.</span><span class="sxs-lookup"><span data-stu-id="edd3f-172">Sessions enable a similar behavior between clients and services as long as the default service instance behavior is used.</span></span> <span data-ttu-id="edd3f-173">Jeśli umowa serwisowa wymaga lub obsługuje sesje, co najmniej jedna operacja umowy może <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> być oznaczona jako inicjująca lub kończąca sesję przez ustawienie właściwości i.</span><span class="sxs-lookup"><span data-stu-id="edd3f-173">If a service contract requires or supports sessions, one or more contract operations can be marked as initiating or terminating a session by setting the <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> and <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> properties.</span></span>  
  
 <span data-ttu-id="edd3f-174">*Inicjowanie operacji* to te, które muszą być wywoływane jako pierwsza operacja nowej sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-174">*Initiating operations* are those that must be called as the first operation of a new session.</span></span> <span data-ttu-id="edd3f-175">Operacje nie inicjujące można wywołać tylko po wywołaniu co najmniej jednej operacji inicjującej.</span><span class="sxs-lookup"><span data-stu-id="edd3f-175">Non-initiating operations can be called only after at least one initiating operation has been called.</span></span> <span data-ttu-id="edd3f-176">W związku z tym można utworzyć rodzaj konstruktora sesji dla usługi, deklarując inicjując operacje przeznaczone do podjęcia danych wejściowych od klientów odpowiednich do początku wystąpienia usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-176">You can therefore create a kind of session constructor for your service by declaring initiating operations designed to take input from clients appropriate to the beginning of the service instance.</span></span> <span data-ttu-id="edd3f-177">(Stan jest skojarzony z sesją, jednak, a nie obiekt usługi.)</span><span class="sxs-lookup"><span data-stu-id="edd3f-177">(The state is associated with the session, however, and not the service object.)</span></span>  
  
 <span data-ttu-id="edd3f-178">*Kończenie operacji*, odwrotnie, to te, które muszą być wywoływane jako ostatnia wiadomość w istniejącej sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-178">*Terminating operations*, conversely, are those that must be called as the last message in an existing session.</span></span> <span data-ttu-id="edd3f-179">W przypadku domyślnego WCF odtwarza obiekt usługi i jego kontekst po sesji, z którą usługa została skojarzona jest zamknięta.</span><span class="sxs-lookup"><span data-stu-id="edd3f-179">In the default case, WCF recycles the service object and its context after the session with which the service was associated is closed.</span></span> <span data-ttu-id="edd3f-180">W związku z tym można utworzyć rodzaj destruktora, deklarując zakończenia operacji przeznaczonych do wykonywania funkcji odpowiednich do końca wystąpienia usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-180">You can, therefore, create a kind of destructor by declaring terminating operations designed to perform a function appropriate to the end of the service instance.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="edd3f-181">Chociaż domyślne zachowanie nosi podobieństwo do lokalnych konstruktorów i destruktorów, jest tylko podobieństwo.</span><span class="sxs-lookup"><span data-stu-id="edd3f-181">Although the default behavior bears a resemblance to local constructors and destructors, it is only a resemblance.</span></span> <span data-ttu-id="edd3f-182">Każda operacja usługi WCF może być operacją inicjującą lub kończącą lub obie jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="edd3f-182">Any WCF service operation can be an initiating or terminating operation, or both at the same time.</span></span> <span data-ttu-id="edd3f-183">Ponadto w przypadku domyślnym inicjowanie operacji można wywołać dowolną liczbę razy w dowolnej kolejności; żadne dodatkowe sesje nie są tworzone po ustanowieniu sesji i skojarzeniu z wystąpieniem, chyba że <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> jawnie kontrolujesz okres istnienia wystąpienia usługi (manipulując obiektem).</span><span class="sxs-lookup"><span data-stu-id="edd3f-183">In addition, in the default case, initiating operations can be called any number of times in any order; no additional sessions are created once the session is established and associated with an instance unless you explicitly control the lifetime of the service instance (by manipulating the <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> object).</span></span> <span data-ttu-id="edd3f-184">Na koniec stan jest skojarzony z sesją, a nie z obiektem usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-184">Finally, the state is associated with the session and not the service object.</span></span>  
  
 <span data-ttu-id="edd3f-185">Na przykład `ICalculatorSession` kontrakt używany w poprzednim przykładzie wymaga, aby obiekt `Clear` klienta WCF najpierw wywołać operację przed inną operacją i że `Equals` sesja z tym obiektem klienta WCF należy zakończyć, gdy wywołuje operację.</span><span class="sxs-lookup"><span data-stu-id="edd3f-185">For example, the `ICalculatorSession` contract used in the preceding example requires that the WCF client object first call the `Clear` operation prior to any other operation and that the session with this WCF client object should terminate when it calls the `Equals` operation.</span></span> <span data-ttu-id="edd3f-186">Poniższy przykład kodu przedstawia kontrakt, który wymusza te wymagania.</span><span class="sxs-lookup"><span data-stu-id="edd3f-186">The following code example shows a contract that enforces these requirements.</span></span> <span data-ttu-id="edd3f-187">`Clear`musi być wywoływana najpierw, aby zainicjować `Equals` sesję, a sesja kończy się, gdy jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="edd3f-187">`Clear` must be called first to initiate a session, and that session ends when `Equals` is called.</span></span>  
  
 [!code-csharp[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/csharp/VS_Snippets_CFX/sca.isinitiatingisterminating/cs/service.cs#1)]
 [!code-vb[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/sca.isinitiatingisterminating/vb/service.vb#1)]  
  
 <span data-ttu-id="edd3f-188">Usługi nie rozpoczynają sesji z klientami.</span><span class="sxs-lookup"><span data-stu-id="edd3f-188">Services do not start sessions with clients.</span></span> <span data-ttu-id="edd3f-189">W aplikacjach klienckich WCF istnieje bezpośrednia relacja między okresem istnienia kanału opartego na sesji a okresem istnienia samej sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-189">In WCF client applications, a direct relationship exists between the lifetime of the session-based channel and the lifetime of the session itself.</span></span> <span data-ttu-id="edd3f-190">W związku z tym klienci tworzą nowe sesje, tworząc nowe kanały oparte na sesji i zburzyć istniejące sesje, zamykając bezpiecznie kanały oparte na sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-190">As such, clients create new sessions by creating new session-based channels and tear down existing sessions by closing session-based channels gracefully.</span></span> <span data-ttu-id="edd3f-191">Klient rozpoczyna sesję z punktem końcowym usługi, wywołując jedną z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="edd3f-191">A client starts a session with a service endpoint by calling one of the following:</span></span>  
  
- <span data-ttu-id="edd3f-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType>na kanale zwróconym przez <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>połączenie do .</span><span class="sxs-lookup"><span data-stu-id="edd3f-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="edd3f-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType>na obiekcie klienta WCF wygenerowanym przez [narzędzie narzędzia ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> on the WCF client object generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span>  
  
- <span data-ttu-id="edd3f-194">Operacja inicjująca na każdym typie obiektu klienta WCF (domyślnie wszystkie operacje są inicjujące).</span><span class="sxs-lookup"><span data-stu-id="edd3f-194">An initiating operation on either type of WCF client object (by default, all operations are initiating).</span></span> <span data-ttu-id="edd3f-195">Po wywołaniu pierwszej operacji obiekt klienta WCF automatycznie otwiera kanał i inicjuje sesję.</span><span class="sxs-lookup"><span data-stu-id="edd3f-195">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="edd3f-196">Zazwyczaj klient kończy sesję z punktem końcowym usługi, wywołując jedną z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="edd3f-196">Typically a client ends a session with a service endpoint by calling one of the following:</span></span>  
  
- <span data-ttu-id="edd3f-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType>na kanale zwróconym przez <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>połączenie do .</span><span class="sxs-lookup"><span data-stu-id="edd3f-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="edd3f-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType>na obiekcie klienta WCF generowanym przez program Svcutil.exe.</span><span class="sxs-lookup"><span data-stu-id="edd3f-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> on the WCF client object generated by Svcutil.exe.</span></span>  
  
- <span data-ttu-id="edd3f-199">Zakończenie operacji na każdym typie obiektu klienta WCF (domyślnie żadne operacje nie kończą działalności; umowa musi jawnie określać operację zakończenia).</span><span class="sxs-lookup"><span data-stu-id="edd3f-199">A terminating operation on either type of WCF client object (by default, no operations are terminating; the contract must explicitly specify a terminating operation).</span></span> <span data-ttu-id="edd3f-200">Po wywołaniu pierwszej operacji obiekt klienta WCF automatycznie otwiera kanał i inicjuje sesję.</span><span class="sxs-lookup"><span data-stu-id="edd3f-200">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="edd3f-201">Na przykład zobacz [Jak: Tworzenie usługi, która wymaga sesji,](./feature-details/how-to-create-a-service-that-requires-sessions.md) a także [domyślne zachowanie usługi](./samples/default-service-behavior.md) i [instancing](./samples/instancing.md) przykłady.</span><span class="sxs-lookup"><span data-stu-id="edd3f-201">For examples, see [How to: Create a Service That Requires Sessions](./feature-details/how-to-create-a-service-that-requires-sessions.md) as well as the [Default Service Behavior](./samples/default-service-behavior.md) and [Instancing](./samples/instancing.md) samples.</span></span>  
  
 <span data-ttu-id="edd3f-202">Aby uzyskać więcej informacji o klientach i sesjach, zobacz [Uzyskiwanie dostępu do usług przy użyciu klienta WCF](./feature-details/accessing-services-using-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-202">For more information about clients and sessions, see [Accessing Services Using a WCF Client](./feature-details/accessing-services-using-a-client.md).</span></span>  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="edd3f-203">Sesje współdziałają z ustawieniami intertekstu wystąpienia</span><span class="sxs-lookup"><span data-stu-id="edd3f-203">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="edd3f-204">Istnieje interakcja <xref:System.ServiceModel.SessionMode> między wyliczeniem w <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> umowie i właściwości, która kontroluje skojarzenie między kanałami i określonych obiektów usługi.</span><span class="sxs-lookup"><span data-stu-id="edd3f-204">There is an interaction between the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property, which controls the association between channels and specific service objects.</span></span> <span data-ttu-id="edd3f-205">Aby uzyskać więcej informacji, zobacz [Sesje, Instancing i Współbieżność](./feature-details/sessions-instancing-and-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="edd3f-205">For more information, see [Sessions, Instancing, and Concurrency](./feature-details/sessions-instancing-and-concurrency.md).</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="edd3f-206">Udostępnianie obiektów instancjowych</span><span class="sxs-lookup"><span data-stu-id="edd3f-206">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="edd3f-207">Można również kontrolować, który kanał oparty na sesji <xref:System.ServiceModel.InstanceContext> lub wywołanie jest skojarzony z który obiekt, wykonując to skojarzenie samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="edd3f-207">You can also control which session-based channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>
  
## <a name="sessions-and-streaming"></a><span data-ttu-id="edd3f-208">Sesje i przesyłanie strumieniowe</span><span class="sxs-lookup"><span data-stu-id="edd3f-208">Sessions and Streaming</span></span>  
 <span data-ttu-id="edd3f-209">Gdy masz dużą ilość danych do transferu, tryb przesyłania strumieniowego w WCF jest wykonalną alternatywą dla domyślnego zachowania buforowania i przetwarzania wiadomości w pamięci w całości.</span><span class="sxs-lookup"><span data-stu-id="edd3f-209">When you have a large amount of data to transfer, the streaming transfer mode in WCF is a feasible alternative to the default behavior of buffering and processing messages in memory in their entirety.</span></span> <span data-ttu-id="edd3f-210">Może wystąpić nieoczekiwane zachowanie podczas przesyłania strumieniowego wywołań z powiązaniem opartym na sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-210">You may get unexpected behavior when streaming calls with a session-based binding.</span></span> <span data-ttu-id="edd3f-211">Wszystkie wywołania przesyłania strumieniowego są dokonywane za pośrednictwem jednego kanału (kanału datagram), który nie obsługuje sesji, nawet jeśli używane powiązanie jest skonfigurowane do używania sesji.</span><span class="sxs-lookup"><span data-stu-id="edd3f-211">All streaming calls are made through a single channel (the datagram channel) that does not support sessions even if the binding being used is configured to use sessions.</span></span> <span data-ttu-id="edd3f-212">Jeśli wielu klientów dokonuje wywołań przesyłania strumieniowego do tego samego obiektu usługi za pośrednictwem powiązania opartego na sesji, `PerSession`a tryb współbieżności obiektu usługi jest ustawiony na jeden, a jego tryb kontekstowy wystąpienia jest ustawiony na , wszystkie wywołania muszą przejść przez kanał datagramu, a więc tylko jedno wywołanie jest przetwarzane w danym momencie.</span><span class="sxs-lookup"><span data-stu-id="edd3f-212">If multiple clients make streaming calls to the same service object over a session-based binding, and the service object's concurrency mode is set to single and its instance context mode is set to `PerSession`, all calls must go through the datagram channel and so only one call is processed at a time.</span></span> <span data-ttu-id="edd3f-213">Jeden lub więcej klientów może następnie limit czasu. Można obejść ten problem, ustawiając obiekt `InstanceContextMode` usługi `PerCall` do lub współbieżności do wielu.</span><span class="sxs-lookup"><span data-stu-id="edd3f-213">One or more clients may then time out. You can work around this issue by either setting the service object's `InstanceContextMode` to `PerCall` or Concurrency to multiple.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="edd3f-214">MaxConcurrentSessions nie mają wpływu w tym przypadku, ponieważ istnieje tylko jedna "sesja" dostępne.</span><span class="sxs-lookup"><span data-stu-id="edd3f-214">MaxConcurrentSessions have no effect in this case because there is only one "session" available.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="edd3f-215">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="edd3f-215">See also</span></span>

- <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A>
- <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A>
