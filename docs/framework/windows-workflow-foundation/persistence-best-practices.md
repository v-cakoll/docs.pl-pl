---
title: Najlepsze rozwiązania w zakresie stanów trwałych
ms.date: 03/30/2017
ms.assetid: 6974c5a4-1af8-4732-ab53-7d694608a3a0
ms.openlocfilehash: 8ffbb3ebfa8f85e2b0052a9df9ada30766accd8e
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802521"
---
# <a name="persistence-best-practices"></a><span data-ttu-id="9aa8f-102">Najlepsze rozwiązania w zakresie stanów trwałych</span><span class="sxs-lookup"><span data-stu-id="9aa8f-102">Persistence Best Practices</span></span>
<span data-ttu-id="9aa8f-103">W tym dokumencie opisano najlepsze rozwiązania dotyczące projektowania i konfigurowania przepływu pracy związane z trwałością przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-103">This document covers best practices for workflow design and configuration related to workflow persistence.</span></span>  
  
## <a name="design-and-implementation-of-durable-workflows"></a><span data-ttu-id="9aa8f-104">Projektowanie i wdrażanie trwałych przepływów pracy</span><span class="sxs-lookup"><span data-stu-id="9aa8f-104">Design and Implementation of Durable Workflows</span></span>  
 <span data-ttu-id="9aa8f-105">Ogólnie rzecz biorąc przepływy pracy działają w krótkich okresach, które są przeplatane z czasem, w którym przepływ pracy jest bezczynny, ponieważ oczekuje na zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-105">In general, workflows perform work in short periods that are interleaved with times during which the workflow is idle because it is waiting for an event.</span></span> <span data-ttu-id="9aa8f-106">To zdarzenie może być takie jak komunikat lub czasomierz wygasania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-106">This event can be such things as a message or an expiring timer.</span></span> <span data-ttu-id="9aa8f-107">Aby można było zwolnić wystąpienie przepływu pracy, gdy stanie się bezczynna, Host usługi musi utrzymywać wystąpienie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-107">To be able to unload the workflow instance when it becomes idle, the service host must persist the workflow instance.</span></span> <span data-ttu-id="9aa8f-108">Jest to możliwe tylko wtedy, gdy wystąpienie przepływu pracy nie znajduje się w strefie no-utrwalania (na przykład oczekiwanie na zakończenie transakcji lub oczekiwanie na asynchroniczne wywołanie zwrotne).</span><span class="sxs-lookup"><span data-stu-id="9aa8f-108">This is possible only if the workflow instance is not in a no-persist zone (for example, waiting for a transaction to complete, or waiting for an asynchronous callback).</span></span> <span data-ttu-id="9aa8f-109">Aby zezwolić na zwalnianie wystąpienia bezczynnego przepływu pracy, autor przepływu pracy powinien używać zakresów transakcji i działań asynchronicznych tylko dla działań krótkoterminowych.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-109">To allow an idle workflow instance to unload, the workflow author should use transaction scopes and asynchronous activities for short-lived actions only.</span></span> <span data-ttu-id="9aa8f-110">W szczególności autor powinien utrzymywać opóźnienia w tych strefach nietrwałych, tak jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-110">In particular, the author should keep delay activities within these no-persist zones as short as possible.</span></span>  
  
 <span data-ttu-id="9aa8f-111">Przepływ pracy można utrwalać tylko wtedy, gdy wszystkie typy danych używane przez przepływ pracy są serializowane.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-111">A workflow can only be persisted if all of the data types used by the workflow are serializable.</span></span> <span data-ttu-id="9aa8f-112">Ponadto typy niestandardowe używane w utrwalonych przepływach pracy muszą być możliwe do serializacji z <xref:System.Runtime.Serialization.NetDataContractSerializer>, aby można było je utrwalić przez <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-112">In addition, custom types used in persisted workflows must be serializable with <xref:System.Runtime.Serialization.NetDataContractSerializer> in order to be persisted by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span></span>  
  
 <span data-ttu-id="9aa8f-113">Wystąpienie przepływu pracy nie może zostać odzyskane w przypadku awarii hosta lub komputera, jeśli nie zostało utrwalone.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-113">A workflow instance cannot be recovered in case of a host or computer failure if it has not been persisted.</span></span> <span data-ttu-id="9aa8f-114">Ogólnie rzecz biorąc zalecamy, aby w cyklu życia przepływu pracy zachować wystąpienie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-114">In general, we recommend that you persist a workflow instance early in the workflow’s life cycle.</span></span>  
  
 <span data-ttu-id="9aa8f-115">Jeśli przepływ pracy jest zajęty przez długi czas, zalecamy regularne utrwalanie wystąpienia przepływu pracy w całym okresie jego zajętości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-115">If your workflow is busy for a long time, we recommend that you persist the workflow instance regularly throughout its busy period.</span></span> <span data-ttu-id="9aa8f-116">Można to zrobić, dodając <xref:System.Activities.Statements.Persist> działania przez sekwencję działań, które zachowują wystąpienie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-116">You can do this by adding <xref:System.Activities.Statements.Persist> activities throughout the sequence of activities that keep the workflow instance busy.</span></span> <span data-ttu-id="9aa8f-117">W ten sposób odtwarzanie domen aplikacji, awarie hosta lub awarie komputerów nie powoduje wycofania systemu z powrotem do początku okresu zajętego.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-117">In this manner, application domain recycling, host failures, or computer failures do not cause the system to be rolled back to the start of the busy period.</span></span> <span data-ttu-id="9aa8f-118">Należy pamiętać, że dodanie <xref:System.Activities.Statements.Persist> działań do przepływu pracy może prowadzić do obniżenia wydajności.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-118">Be aware that adding <xref:System.Activities.Statements.Persist> activities to your workflow could lead to a degradation of performance.</span></span>  
  
 <span data-ttu-id="9aa8f-119">Sieć szkieletowa aplikacji systemu Windows Server znacznie upraszcza konfigurację i użycie trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-119">Windows Server App Fabric greatly simplifies the configuration and use of persistence.</span></span> <span data-ttu-id="9aa8f-120">Aby uzyskać więcej informacji, zobacz [trwałość sieci szkieletowej aplikacji systemu Windows Server](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10))</span><span class="sxs-lookup"><span data-stu-id="9aa8f-120">For more information, see [Windows Server App Fabric Persistence](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10))</span></span>  
  
## <a name="configuration-of-scalability-parameters"></a><span data-ttu-id="9aa8f-121">Konfiguracja parametrów skalowalności</span><span class="sxs-lookup"><span data-stu-id="9aa8f-121">Configuration of Scalability Parameters</span></span>  
 <span data-ttu-id="9aa8f-122">Wymagania dotyczące skalowalności i wydajności określają ustawienia następujących parametrów:</span><span class="sxs-lookup"><span data-stu-id="9aa8f-122">Scalability and performance requirements determine the settings of the following parameters:</span></span>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A>  
  
- <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A>  
  
 <span data-ttu-id="9aa8f-123">Parametry te należy ustawić w następujący sposób zgodnie z bieżącym scenariuszem.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-123">These parameters should be set as follows, according to the current scenario.</span></span>  
  
### <a name="scenario-a-small-number-of-workflow-instances-that-require-optimal-response-time"></a><span data-ttu-id="9aa8f-124">Scenariusz: niewielka liczba wystąpień przepływów pracy, które wymagają optymalnego czasu odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="9aa8f-124">Scenario: A Small Number of Workflow Instances That Require Optimal Response Time</span></span>  
 <span data-ttu-id="9aa8f-125">W tym scenariuszu wszystkie wystąpienia przepływu pracy powinny pozostawać w stanie bezczynności.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-125">In this scenario, all workflow instances should remain loaded when they become idle.</span></span> <span data-ttu-id="9aa8f-126">Ustaw <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na dużą wartość.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-126">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to a large value.</span></span> <span data-ttu-id="9aa8f-127">Użycie tego ustawienia uniemożliwia przechodzenie wystąpienia przepływu pracy między komputerami.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-127">The use of this setting prevents a workflow instance from moving between computers.</span></span> <span data-ttu-id="9aa8f-128">Tego ustawienia należy używać tylko w przypadku, gdy co najmniej jeden z następujących warunków jest spełniony:</span><span class="sxs-lookup"><span data-stu-id="9aa8f-128">Use this setting only if one or more of the following are true:</span></span>  
  
- <span data-ttu-id="9aa8f-129">Wystąpienie przepływu pracy odbiera pojedynczy komunikat w okresie istnienia.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-129">A workflow instance receives a single message throughout its lifetime.</span></span>  
  
- <span data-ttu-id="9aa8f-130">Wszystkie wystąpienia przepływu pracy są uruchamiane na pojedynczym komputerze</span><span class="sxs-lookup"><span data-stu-id="9aa8f-130">All workflow instances run on a single computer</span></span>  
  
- <span data-ttu-id="9aa8f-131">Wszystkie komunikaty odbierane przez wystąpienie przepływu pracy są odbierane przez ten sam komputer.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-131">All messages that are received by a workflow instance are received by the same computer.</span></span>  
  
 <span data-ttu-id="9aa8f-132">Użyj działań <xref:System.Activities.Statements.Persist> lub ustaw <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> na 0, aby włączyć odzyskiwanie wystąpienia przepływu pracy po awarii hosta usługi lub komputera.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-132">Use <xref:System.Activities.Statements.Persist> activities or set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to enable recovery of your workflow instance after service host or computer failures.</span></span>  
  
### <a name="scenario-workflow-instances-are-idle-for-long-periods-of-time"></a><span data-ttu-id="9aa8f-133">Scenariusz: wystąpienia przepływu pracy są bezczynne przez długi okres czasu</span><span class="sxs-lookup"><span data-stu-id="9aa8f-133">Scenario: Workflow Instances Are Idle for Long Periods of Time</span></span>  
 <span data-ttu-id="9aa8f-134">W tym scenariuszu Ustaw dla <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> wartość 0, aby jak najszybciej zwolnić zasoby.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-134">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0 to release resources as soon as possible.</span></span>  
  
### <a name="scenario-workflow-instances-receive-multiple-messages-in-a-short-period-of-time"></a><span data-ttu-id="9aa8f-135">Scenariusz: wystąpienia przepływu pracy odbierają wiele komunikatów w krótkim czasie</span><span class="sxs-lookup"><span data-stu-id="9aa8f-135">Scenario: Workflow Instances Receive Multiple Messages in a Short Period of Time</span></span>  
 <span data-ttu-id="9aa8f-136">W tym scenariuszu Ustaw <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na 60 sekund, jeśli te komunikaty są odbierane przez ten sam komputer.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-136">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 60 seconds if these messages are received by the same computer.</span></span> <span data-ttu-id="9aa8f-137">Zapobiega to szybkiemu wyładowaniu i ładowaniu wystąpienia przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-137">This prevents a rapid sequence of unloading and loading of a workflow instance.</span></span> <span data-ttu-id="9aa8f-138">Nie zachowuje to również wystąpienia w pamięci zbyt długo.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-138">This also does not keep the instance in memory for too long.</span></span>  
  
 <span data-ttu-id="9aa8f-139">Ustaw wartość <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na 0 i ustaw <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> na BasicRetry lub AggressiveRetry, jeśli te komunikaty mogą być odbierane przez różne komputery.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-139">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0, and set <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if these messages may be received by different computers.</span></span> <span data-ttu-id="9aa8f-140">Pozwala to na załadowanie wystąpienia przepływu pracy przez inny komputer.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-140">This allows the workflow instance to be loaded by another computer.</span></span>  
  
### <a name="scenario-workflow-uses-delay-activities-with-short-durations"></a><span data-ttu-id="9aa8f-141">Scenariusz: przepływ pracy używa opóźnień z krótkimi czasami trwania</span><span class="sxs-lookup"><span data-stu-id="9aa8f-141">Scenario: Workflow Uses Delay Activities with Short Durations</span></span>  
 <span data-ttu-id="9aa8f-142">W tym scenariuszu <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularnie sonduje trwałość bazy danych dla wystąpień, które powinny być ładowane z powodu wygasłych działań <xref:System.Activities.Statements.Delay>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-142">In this scenario, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularly polls the persistence database for instances that should be loaded because of an expired <xref:System.Activities.Statements.Delay> activity.</span></span> <span data-ttu-id="9aa8f-143">Jeśli <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> odnajdzie czasomierz, który wygaśnie w następnym interwale sondowania, magazyn wystąpień programu SQL Workflow skraca interwał sondowania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-143">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, the SQL Workflow Instance Store shortens the polling interval.</span></span> <span data-ttu-id="9aa8f-144">Następne sondowanie będzie odbywać się po wygaśnięciu czasomierza.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-144">The next poll will then occur right after the timer has expired.</span></span> <span data-ttu-id="9aa8f-145">W ten sposób magazyn wystąpień przepływu pracy SQL osiąga dużą dokładność czasomierzy, które są uruchamiane dłużej niż interwał sondowania ustawiony przez <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-145">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than the polling interval, which is set by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span> <span data-ttu-id="9aa8f-146">Aby włączyć czas przetwarzania krótszych opóźnień, wystąpienie przepływu pracy musi pozostawać w pamięci dla co najmniej jednego interwału sondowania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-146">To enable timely processing of shorter delays, the workflow instance must remain in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="9aa8f-147">Ustaw wartość <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> na 0, aby zapisać czas wygaśnięcia dla bazy danych trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-147">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to write the expiration time to the persistence database.</span></span>  
  
 <span data-ttu-id="9aa8f-148">Ustaw wartość <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> na większą lub równą <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, aby zachować wystąpienie w pamięci dla co najmniej jednego interwału sondowania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-148">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to longer than or equal to <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to keep the instance in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="9aa8f-149">Nie zalecamy zredukowania <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, ponieważ prowadzi to do zwiększonego obciążenia bazy danych trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-149">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="9aa8f-150">Każdy host usługi, który używa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonduje bazę danych jeden raz na okres wykrywania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-150">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="9aa8f-151">Ustawienie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> na zbyt mały czas przedziału czasu może spowodować spadek wydajności systemu, jeśli liczba hostów usługi jest duża.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-151">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small a time interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
## <a name="configuring-the-sql-workflow-instance-store"></a><span data-ttu-id="9aa8f-152">Konfigurowanie magazynu wystąpień przepływu pracy SQL</span><span class="sxs-lookup"><span data-stu-id="9aa8f-152">Configuring the SQL Workflow Instance Store</span></span>  
 <span data-ttu-id="9aa8f-153">Magazyn wystąpień przepływu pracy SQL zawiera następujące parametry konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="9aa8f-153">The SQL Workflow Instance Store has the following configuration parameters:</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceEncodingOption%2A>  
 <span data-ttu-id="9aa8f-154">Ten parametr instruuje <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>, aby kompresuje stan wystąpienia przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-154">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to compress the workflow instance state.</span></span> <span data-ttu-id="9aa8f-155">Kompresja zmniejsza ilość danych przechowywanych w bazie danych trwałości i zmniejsza ruch sieciowy w przypadku, gdy baza danych trwałości znajduje się na dedykowanym serwerze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-155">Compression reduces the amount of data that is stored in the persistence database and reduces network traffic in case the persistence database resides on a dedicated database server.</span></span> <span data-ttu-id="9aa8f-156">Jeśli kompresja jest używana, wymaga zasobów obliczeniowych w celu kompresowania i wyodrębnienia stanu wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-156">If compression is used, it requires computational resources to compress and extract the instance state.</span></span> <span data-ttu-id="9aa8f-157">W większości przypadków kompresja zapewnia zwiększoną wydajność.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-157">In most cases, compression yields increased performance.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceCompletionAction%2A>  
 <span data-ttu-id="9aa8f-158">Ten parametr nakazuje <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> zachowywania lub usuwania ukończonych wystąpień.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-158">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to either keep or delete completed instances.</span></span> <span data-ttu-id="9aa8f-159">Utrzymywanie zakończonych wystąpień zwiększa wymagania dotyczące magazynu bazy danych trwałości i prowadzi do większych tabel, co zwiększa czas wyszukiwania tabeli.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-159">Keeping completed instances increases the persistence database storage requirements and leads to larger tables, which increases table lookup times.</span></span> <span data-ttu-id="9aa8f-160">Jeśli nie są wymagane żadne ukończone wystąpienia dla debugowania lub inspekcji, najlepiej jest poinstruować <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>, aby usunąć ukończone wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-160">Unless completed instances are required for debugging or auditing, it is best to instruct the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to delete completed instances.</span></span> <span data-ttu-id="9aa8f-161">Usunięte wystąpienia powinny być przechowywane tylko wtedy, gdy użytkownik ustanowi proces, aby ostatecznie je usunąć.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-161">Deleted instances should be kept only if the user establishes a process for eventually removing them.</span></span> <span data-ttu-id="9aa8f-162">Należy zauważyć, że nie można ponownie użyć kluczy korelacji, o ile ukończone wystąpienie przepływu pracy znajduje się w magazynie wystąpień.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-162">Note that correlation keys cannot be reused as long as the completed workflow instance resides in the instance store.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>  
 <span data-ttu-id="9aa8f-163">Ten parametr określa maksymalny interwał, za pomocą którego <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonduje trwałość bazy danych dla wystąpień, które powinny być ładowane po wygaśnięciu działania <xref:System.Activities.Statements.Delay>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-163">This parameter defines the maximum interval with which the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the persistence database for instances that should be loaded when a <xref:System.Activities.Statements.Delay> activity expires.</span></span> <span data-ttu-id="9aa8f-164">Jeśli <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> odnajdzie czasomierz, który wygaśnie w następnym interwale sondowania, skraca interwał sondowania, aby następne sondowanie zakończyło się bezpośrednio po wygaśnięciu czasomierza.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-164">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, it shortens the polling interval so that the next poll will occur right after the timer has expired.</span></span> <span data-ttu-id="9aa8f-165">W ten sposób magazyn wystąpień przepływu pracy SQL osiąga dużą dokładność czasomierzy, które są uruchamiane dłużej niż <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-165">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span>  
  
 <span data-ttu-id="9aa8f-166">Nie zalecamy zmniejszenia <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, ponieważ prowadzi to do zwiększonego obciążenia bazy danych trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-166">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="9aa8f-167">Każdy host usługi, który używa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonduje bazę danych jeden raz na okres wykrywania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-167">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="9aa8f-168">Ustawienie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> na zbyt mały interwał może spowodować spadek wydajności systemu, jeśli liczba hostów usług jest duża.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-168">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small an interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>  
 <span data-ttu-id="9aa8f-169">Ten parametr określa interwał, za pomocą którego host odnawia blokadę w bazie danych trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-169">This parameter defines the interval with which the host renews its lock in the persistence database.</span></span> <span data-ttu-id="9aa8f-170">Skrócenie tego interwału umożliwi szybsze odzyskiwanie wystąpień przepływów pracy na wypadek awarii hosta lub komputera.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-170">Shortening this interval will enable a quicker recovery of the workflow instances in case a host or computer fails.</span></span> <span data-ttu-id="9aa8f-171">Z drugiej strony, krótki okres odnawiania blokady zwiększa obciążenie bazy danych trwałości.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-171">On the other hand, a short lock renewal period increases the load on the persistence database.</span></span> <span data-ttu-id="9aa8f-172">Każdy host usługi, który używa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>, zaktualizuje jego blokady w bazie danych o jeden raz na okres odnawiania.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-172">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> will update its locks in the database one time per renewal period.</span></span> <span data-ttu-id="9aa8f-173">Jeśli na komputerze jest uruchomionych wiele hostów usługi, upewnij się, że obciążenie spowodowane odnowieniem blokady nie zmniejsza wydajności systemu.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-173">If a computer runs many service hosts, make sure that the load caused by lock renewal does not decrease your system's performance.</span></span> <span data-ttu-id="9aa8f-174">Jeśli tak, rozważ zwiększenie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-174">If it does, consider increasing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>  
 <span data-ttu-id="9aa8f-175">Jeśli ta funkcja jest włączona, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> ponawia próbę załadowania zablokowanego wystąpienia przez następne 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-175">If enabled, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> retries to load a locked instance for the next 30 seconds.</span></span> <span data-ttu-id="9aa8f-176">Ustaw wartość <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> BasicRetry lub AggressiveRetry, jeśli przepływ pracy odbiera wiele komunikatów w krótkim czasie, a te komunikaty są odbierane przez różne komputery.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-176">Set <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if the workflow receives multiple messages in a short time, and these messages are received by different computers.</span></span>  
  
 <span data-ttu-id="9aa8f-177">Ze względu na to, że mechanizm ponawiania obciążenia nie wprowadza żadnych obciążeń związanych z wydajnością, o ile nie są podejmowane próby załadowania, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> powinny być zawsze włączone.</span><span class="sxs-lookup"><span data-stu-id="9aa8f-177">Because the load retry mechanism does not introduce any performance overhead as long as load retries are not tried, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> should always be enabled.</span></span>
